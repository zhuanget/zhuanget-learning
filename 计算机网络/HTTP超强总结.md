## 报文结构

1.起始行：描述请求或响应的基本信息；

2.头部字段集合：使用key-value形式更详细地说明报文；

3.消息正文：实际传输的数据，它不一定是纯文本，可以是图片、视频等二进制数据。

起始行和头部字段经常又合称为“请求头”或“响应头”，消息正文又称为“实体”。

HTTP协议规定报文必须有header，但可以没有body，而且在header之后必须要有一个“空行”，也就是“CRLF”。

![报文结构](D:\学习\记录笔记\zhuanget-learning\图片\62e061618977565c22c2cf09930e1d3c.png)

## 请求行

请求报文里的起始行，即请求行，它简要地描述了客户端想要如何操作服务器端的资源。

请求行由三部分构成：

1.请求方法：是一个动词，如GET/POST，表示对资源的操作；

2.请求目标：通常是一个URI，标记了请求方法要操作的资源；

3.版本号：表示报文使用的HTTP协议版本。

这三个部分通常使用空格来分隔，最后要用CRLF换行表示结束。

![请求行](D:\学习\记录笔记\zhuanget-learning\图片\请求行.png)

## 状态行

响应报文里的起始行，叫“状态行”，意思是服务器响应的状态。

状态行同样是由三部分构成：

1.版本号：表示报文使用的HTTP协议版本；

2.状态码：一个三位数，用代码的形式表示处理的结果；

3.原因：状态码的补充说明，是更详细的解释文字，帮助人理解原因。

![状态行](D:\学习\记录笔记\zhuanget-learning\图片\状态行.png)

## 头部字段

头部字段是key-value的形式，key和value之间用“:”分隔，最后用CRLF换行表示字段结束。

### 常用头字段

HTTP协议规定了非常多的头部字段，基本上可以分为四大类：

1.通用字段：在请求头和响应头里都可以出现；

2.请求字段：仅能出现在请求头里，进一步说明请求信息或者额外的附件条件；

3.响应字段：仅能出现在响应头里，补充说明响应报文的信息；

4.实体字段：它实际上属于通用字段，但专门描述body的额外信息。

#### Host

请求字段，HTTP/1.1规范里要求必须出现的字段。Host字段告诉服务器这个请求应该由哪个主机来处理，当一台计算机上托管了多个虚拟主机的时候，服务器端就需要用Host字段来选择。

#### User-Agent

请求字段，服务器可以依据它来返回最合适此浏览器显示的页面。

#### Date

通用字段，但通常出现在响应头里，表示HTTP报文创建的时间。

#### Server

响应字段，告诉客户端正在提供Web服务的软件名称和版本号。

#### Content-Length

表示报文里body的长度，也就是请求头或响应头空行后面数据的长度。服务器看到这个字段，就知道了后续有多少数据，可以直接接收。如果没有这个字段，那么body就是不定长的，需要使用chunked方式分段传输。

## 请求方法

八种方法：

1、GET：获取资源，读取或者下载数据；

2、HEAD：获取资源的元信息；

3、POST：向资源提交数据，相当于写入或上传数据；

4、PUT：类似POST；

5、DELETE：删除资源；

6、CONNECT：建立特殊的连接隧道；

7、OPTIONS：列出可对资源实行的方法；

8、TRACE：追踪请求-响应的传输路径。

**HEAD**方法与GET方法类似，也是请求从服务器获取资源，服务器的处理机制也是一样的，但服务器不会返回请求的实体数据，只会返回响应头。

## 安全与幂等

**安全：**在HTTP协议里，安全是指请求方法不会破坏服务器上的资源，即不会对服务器上的资源造成实质的修改。GET和HEAD方法是安全的，因为它们是只读操作。

**幂等：**意思是多次执行相同的操作，结果也都是相同的。

GET/HEAD/DELETE/PUT是幂等的，POST不是幂等的。

## 状态码

五类：

* 1XX：提示信息，表示目前是协议处理的中间状态，还需要后续的操作；
* 2XX：成功，报文已经收到并被正确处理；
* 3XX：重定向，资源位置发送变动，需要客户端重新发送请求；
* 4XX：客户端错误，请求报文有误，服务器无法处理；
* 5XX：服务器错误，服务器在处理请求时内部发送了错误。

### 2xx

**200 OK**

**204 No Content**：含义与200基本相同，但响应头后没有body数据。

**206 Partial Content：**是HTTP分块下载或断点续传的基础，在客户端发送“范围请求”、要求获取资源的部分数据时出现，状态码206通常还会伴随着头字段“Content-Range”，表示响应报文里body数据的具体范围，供客户端确认。

### 3xx

**301 Moved Permanently：**永久重定向，此次请求的资源已经不存在了，需要改用新的URI再次访问。

**302 Moved Temporarily：**临时重定向，意思是请求的资源还在，但需要暂时用另一个URI来访问。

301和302都会在响应头里使用字段Location指明后续要跳转的URI，最终的效果很相似，浏览器都会重定向到新的URI。

**304 Not Modified：**用于If-Modified-Since等条件请求，表示资源未修改，用于缓存控制。它不具有通常的跳转含义，但可以理解成“重定向已到缓存的文件”（即“缓存重定向”）。

### 4xx

**400 Bad Request：**通用的错误码，表示请求报文有错误，但具体是数据格式错误、缺少请求头还是URI超长没有明确说。

**403 Forbidden：**实际上不是客户端的请求出错，而是表示服务器禁止访问资源。

**404 Not Found：**

**405 Method Not Allowed：**不允许使用某些方法操作资源。

### 5xx

**500 Internal Server Error：**通用错误码。

**503 Service Unavailable：**表示服务器当前很忙，暂时无法响应服务。