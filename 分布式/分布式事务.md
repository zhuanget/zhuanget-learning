## 写在前面

参考比较好的文章：https://www.cnblogs.com/crazymakercircle/p/14375424.html

## 一、事务

满足ACID

## 二、分布式理论

CAP理论和BASE理论

* CAP定理：WEB服务不可能同时满足一致性C、可用性A、分区容错性P这三个特性，一般需要做取舍，由于分布式系统P是必须具备的，所以一般是在C和A间做取舍。
* BASE理论：满足基本可用(BA)、软状态(S)、最终一致性(E)，
  * 基本可用：指分布式系统中出现不可预知的故障时，允许损失部分可用性；
  * 软状态：指允许系统中的数据存在中间状态，并认为该中间状态的存在不会影响系统的整体可用性；
  * 最终一致：强调的是所有的数据更新操作，在经过一段时间的同步之后，最终都能够达到一个一致的状态。因此，最终一致性的本质是需要系统保证最终数据能够达到一致，而不需要实时保证系统数据的强一致性。

## 三、二阶段提交和三阶段提交

### 3.1、二阶段提交(2PC)

2PC有个协调者和多个参与者，一阶段，请求/表决，发送方向协调者请求发起事务，协调者向参与者发送事务处理请求；二阶段，提交/执行，分正常流程和异常流程。

缺点：

* 性能问题：执行过程中，节点都处于阻塞状态，占用着数据库资源，只有当所有节点都提交，协调者发送全局处理后，才能够释放资源；
* 单点故障：依赖于协调者，当协调者出现故障时，参与者将处于事务无法完成的中间状态；
* 数据不一致性：如果提交阶段有参与者未收到提交消息，会导致节点间的不一致问题。