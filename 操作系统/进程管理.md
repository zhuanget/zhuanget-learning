进程与线程

进程是一段代码在某个数据集上的一次执行过程。进程是系统资源分配的基本单位，由代码段、数据段和进程控制块（PCB）组成。线程是系统调度和分配的基本单位，线程除了拥有一些运行必不可少的资源外，不拥有资源，同一进程上的多个线程共享该进程上的资源。

进程与线程的区别

* 线程依托于进程进程存在，一个线程所属于一个进程，但一个进程可以有多个线程；
* 拥有资源：线程本身不拥有资源，只拥有一些必不可少的资源，而进程是系统资源分配的基本单位，同一进程上的多个进程共享该进程上的资源；
* 调度：同一进程上的线程切换不会引起进程的切换，只有不同进程上的线程切换时才会引起进程的切换；
* 系统开销：系统创建或撤销一个进程都需要为其分配或回收资源，如内存资源、IO设备等，相比于创建或撤销一个线程，所付出的开销要大很多；同样当发生进程切换时，所付出的开销也要比线程切换的开销大，因为进程切换需要保存当前进程的运行环境，并为新的进程设置运行环境。而线程切换只需要保存少量的寄存器资源，开销较小。

线程同步的方式

* 互斥量：通过互斥对象来控制线程访问系统资源，由于互斥对象只有一个，因此可以保证同一时刻访问某一资源的线程只有一个，像Java中的synchronized和各种Lock就是基于互斥量机制实现的；
* 信号量：允许同一时刻可以有多个线程访问同一系统资源，但是需要控制同一时刻访问该资源的最大线程数量；
* 事件（信号）：通过通知的方式来进行现场同步，还可以很方便地实现优先级，Java的notify/wait。

进程同步的方式：

进程同步的方式有：原子操作、信号量机制、管程。

几个相关概念：

* 临界区：访问临界资源的那段代码，需要互斥访问临界资源，在每次进入临界区时都需要进行检查；
* 互斥与同步：同步：多个进程之间由于合作关系产生的直接制约关系，使得多个进程之间存在一定的先后执行顺序；互斥：同一时刻只能有一个进程进程可以访问临界资源。
* 信号量：信号量是一个整型，表示允许同一时刻访问资源的最大进程数量，可以进程PV操作。
* 管程：由于信号量机制需要客户端编写大量的访问资源的代码，程序复杂，管程将访问资源的操作独立出来，不仅可以避免出错，还可以降低程序开发的复杂性。

进程通信的方式：

1、共享存储块

多个进程访问系统中的同一块内存，由于数据不需要在多个进程间复制，因此是最快的一种进程通信方式。

2、消息传递

进程之间以一种格式化的数据进行通信，分为直接消息传递和间接消息传递。

3、管道

管道通过调用系统函数pipe()创建，管道是一种固定大小的文件，称为pipe文件，当文件未满时，写进程可以往其中写入数据，当文件满时，写进程会被阻塞直到读进程将其中的数据读出；同样，当文件为空时，读进程会被阻塞直到写进程往里面写入数据。

管道使用有以下限制：

* 它是一种半双工的通信方式；
* 只能用于父子进程、兄弟进程之间。

4、命名管道

与管道类似，但它消除了只能用于父子进程、兄弟进程之间的限制。

5、套接字

与其他的进程通信方式不同，该方式可以用于不同主机进程间的通信。

进程调度算法/策略

1、先来先服务（FCFS)

按照先来后到的顺序放入队列中，当一个进程执行完后调度下一个进程，缺点是不利于短进程，因为短进程需要等待排在其前面的长进程执行完后才能被调度到，等待时间长。

2、短作业优先（SJF)

短作业优先算法根据估算的进程执行时间长短进行调度，估算时间短的先被调度，该算法可能存在进程饥饿现象，即长作业的进程长时间得不到调度。

3、时间片轮转

系统设置一个时间片大小，所有就绪进程放到就绪队列里，按照顺序调度，如果在时间片内运行进程未执行完，就将其放到就绪队列的末尾，等待新一轮调度。该算法需要考虑时间片大小的设置，时间片设置太小会造成进程切换太过频繁，设置太大则会造成退化为FCFS。

4、优先级算法

为每个进程设置优先级大小，根据优先级大小调度进程，该算法可以根据等待时间调高进程优先级，避免低优先级进程长时间得不到调度。

5、多级反馈队列

该算法是时间片轮转和优先级算法的结合，通过设置多个队列，只有当上面的队列为空时，才可以调度当前队列中的进程。

进程状态及转换

进程状态：就绪、运行、阻塞。

就绪->运行：当一个进程获取到系统分配的时间片资源，就将从就绪态转入运行态。

运行->就绪：当一个运行进程的时间片用完或者被更高级别的进程抢占CPU时，就从运行态转为就绪态。

运行->阻塞：当一个进程中等待某个事件发生，如等待某个资源可用时，就会被阻塞。

阻塞->就绪：当阻塞进程等待的事件发生时，如所等待的某个资源例如IO设备释放而可用时，就从阻塞态转为就绪态，等待CPU的调度执行。

孤儿进程、僵尸进程、守护进程

1、孤儿进程

当一个父进程终止时，其所有子进程就将被托孤给init进程，这些子进程就称为孤儿进程。

2、僵尸进程

Linux的进程状态中有一种僵死状态，当某个进程执行完毕，而其父进程尚未获取其信息时，就处于一种僵死状态，此时进程就称为僵尸进程。僵尸进程尚未终止，还消耗系统资源，保留一定的状态信息供父进程查询，只有当父进程获取其状态信息后，该进程才进入终止。

3、守护进程

守护进程是在后台运行，不与任何终端关联的进程。

**说一说自己对进程和线程的理解吧**

首先是程序，程序是磁盘上的一个可执行文件，内核通过exec函数，将程序读入内存，然后执行程序。而进程是程序的一个实例，系统要执行程序，会准备好环境，分配好内存，将程序读入内存，然后当有CPU时间片时，就读取程序执行。而进程通常会有一个控制线程，是某一时刻执行的一组机器指令。但进程可以有多个控制线程，作用于它的不同部分，就可以更好地解决问题。